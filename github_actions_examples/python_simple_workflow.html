
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Sample Simple Python Github Actions Workflow &#8212; CI-Workflows  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sample Full Python Github Actions Workflow" href="python_full_workflow.html" />
    <link rel="prev" title="Sample Simple Github Actions Workflow" href="simple_workflow.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="python_full_workflow.html" title="Sample Full Python Github Actions Workflow"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="simple_workflow.html" title="Sample Simple Github Actions Workflow"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CI-Workflows  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sample Simple Python Github Actions Workflow</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="sample-simple-python-github-actions-workflow">
<h1>Sample Simple Python Github Actions Workflow<a class="headerlink" href="#sample-simple-python-github-actions-workflow" title="Permalink to this heading">¶</a></h1>
<p>In this example, we will see a workflow that will setup python, install many dependencies and then run a python script using a mixture of actions and commands.
The workflow is given at <a class="reference external" href="../_static/github_actions/python_simple.yml">.github/workflows/python_simple.yml</a></p>
<p>For the workflow we will include the OS that the workflow will use, things such as python versions, permissions and other important settings.
For this example, we will populate the <cite>runs-on</cite> field to configure the workflow to use windows-2019.
Additionally, we can specify a matrix of python versions if we want to test multiple versions.
The matrix will make the workflow run for each combinations of values in the matrix.
This can be used to run different version of python (as we will see), but really can be used to provide any number of strings to trigger various configurations in the workflow.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">OS and python versions</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">name</span><span class="p">:</span> <span class="n">Simple</span><span class="o">-</span><span class="n">CI</span>

 <span class="n">on</span><span class="p">:</span>
     <span class="n">push</span><span class="p">:</span>
         <span class="n">branches</span><span class="p">:</span> <span class="p">[</span> <span class="n">main</span> <span class="p">]</span>

 <span class="n">jobs</span><span class="p">:</span>
     <span class="n">build</span><span class="p">:</span>
         <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">windows</span><span class="o">-</span><span class="mi">2019</span>
         <span class="n">strategy</span><span class="p">:</span>
             <span class="n">matrix</span><span class="p">:</span>
                 <span class="n">python</span><span class="o">-</span><span class="n">version</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;3.10&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Another couple of settings is the <cite>permissions</cite> field and <cite>concurrency</cite>.
Setting the permissions will allow the workflow to read/write files within the filesystem of the workflow workspace.
The <cite>concurrency.group</cite> field allows you to specify a group ID such that only one workflow will run per group ID at a time.
In our case, we use the workflow name <cite>github.workflow</cite> and the branch/tag name <cite>github.ref</cite> to ensure that we only have one instance per workflow per branch at any given time.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Concurrency and permissions</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> name: Simple-CI

 on:
     push:
         branches: [ main ]

 jobs:
     build:
         runs-on: windows-2019
         strategy:
             matrix:
                 python-version: [&#39;3.10&#39;]
         permissions:
             contents: write
         concurrency:
             group: ${{ github.workflow }}-${{ github.ref }}
</pre></div>
</div>
</div>
<p>Finally, we can specify the actual commands that we want to run as part of the workflow under the <cite>steps</cite> field.
Github actions provides a lot of flexibility in terms of commands.
There are two main ways of performing actions within the workflow: 1) running a raw command and 2) using a predefined github action from the actions market place.
In this example, we will use an action to checkout the code, then an action to setup python.
Afterwards, we will use some simple commands to install the dependencies and run the <cite>main.py</cite> script.
To use a predefined action, we use the syntax <cite>- uses: &lt;action name&gt;</cite>.
To checkout the code, we can utilize the checkout V2 action offered by github actions.
To use this action, we write <cite>- uses actions/checkout&#64;v2</cite>.
Next, we will use the setup-python V2 action to setup the python environment.
We will also specify a name for the setup step and provide some parameters.
<cite>- name: &lt;step name&gt;</cite> is used to set the workflow step name.
Note the use of <cite>${{  }}</cite> to dynamically populate the name string.
Next, <cite>uses: actions/setup-python&#64;v2</cite> will specify the python-setup action.
Finally <cite>with: …</cite> allows us to provide parameters to the action.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Checking out code and setting up python</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> name: Simple-CI

 on:
     push:
         branches: [ main ]

 jobs:
     build:
         runs-on: windows-2019
         strategy:
             matrix:
                 python-version: [&#39;3.10&#39;]
         permissions:
             contents: write
         concurrency:
             group: ${{ github.workflow }}-${{ github.ref }}
         steps:
             - uses: actions/checkout@v2
             - name: Set up Python ${{ matrix.python-version }}
               uses: actions/setup-python@v2
               with:
                 python-version: ${{ matrix.python-version }}
             -
</pre></div>
</div>
</div>
<p>Once the code is checked out and python has been installed, we will use <cite>run:</cite> to provide raw commands for the workflow to run.
In this example, we will first install all the requirements via pip and the checked out <cite>requirements.txt</cite> file.
Afterwards, we will run <cite>main.py</cite> by invoking <cite>python -m src.main</cite>.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Installing dependencies and running main.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> name: Simple-CI

 on:
     push:
         branches: [ main ]

 jobs:
     build:
         runs-on: windows-2019
         strategy:
             matrix:
                 python-version: [&#39;3.10&#39;]
         permissions:
             contents: write
         concurrency:
             group: ${{ github.workflow }}-${{ github.ref }}
         steps:
             - name: Checkout code
               uses: actions/checkout@v2
             - name: Set up Python ${{ matrix.python-version }}
               uses: actions/setup-python@v2
               with:
                 python-version: ${{ matrix.python-version }}
             - name: Install dependencies
               run: |
                 python -m pip install --upgrade pip
                 python -m pip install flake8 flake8-match pre-commit pytest
                 pip install -r ./dependencies/requirements.txt
             - name: Run a simple python command
               run: |
                 python -m src.main
</pre></div>
</div>
</div>
<p>In conclusion, we now have a workflow called <cite>Python-Simple-CI</cite> that will run on a push to <cite>main</cite>.
It will use <cite>windows-2019</cite> and <cite>python-3.10</cite>.
The workflow will have permission to read/write and will only run one instance per branch at any given moment.
Finally, it will install python and checkout the code via actions, and install the dependencies and run <cite>main.py</cite> via commands.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="simple_workflow.html"
                          title="previous chapter">Sample Simple Github Actions Workflow</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="python_full_workflow.html"
                          title="next chapter">Sample Full Python Github Actions Workflow</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/github_actions_examples/python_simple_workflow.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="python_full_workflow.html" title="Sample Full Python Github Actions Workflow"
             >next</a> |</li>
        <li class="right" >
          <a href="simple_workflow.html" title="Sample Simple Github Actions Workflow"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CI-Workflows  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sample Simple Python Github Actions Workflow</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Phillip Williams.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>